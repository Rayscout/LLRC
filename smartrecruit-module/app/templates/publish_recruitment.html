{% extends 'base.html' %}

{% block title %}发布招聘启事{% endblock %}

{% block content %}
<div class="publish-recruitment">
    <div class="page-header">
        <div class="header-icon">
            <i class="uil uil-megaphone"></i>
        </div>
        <div class="header-content">
            <h1>{% if is_edit %}编辑招聘启事{% else %}发布招聘启事{% endif %}</h1>
            <p>{% if is_edit %}修改招聘信息，保持信息最新{% else %}创建详细的招聘信息，吸引优秀人才{% endif %}</p>
        </div>
    </div>

    <form action="{{ url_for('main.publish_recruitment') }}" method="post" class="recruitment-form">
        <div class="form-sections">
            <!-- 基本信息 -->
            <div class="form-section">
                <h3><i class="uil uil-info-circle"></i> 基本信息</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="title">职位名称 <span class="required">*</span></label>
                        <input type="text" id="title" name="title" placeholder="如：高级软件工程师" 
                               value="{{ job.title if job else '' }}" required>
                    </div>
                    <div class="form-group">
                        <label for="department">所属部门</label>
                        <input type="text" id="department" name="department" placeholder="如：技术部"
                               value="{{ job.department if job else '' }}">
                    </div>
                    <div class="form-group">
                        <label for="location">工作地点 <span class="required">*</span></label>
                        <input type="text" id="location" name="location" placeholder="如：北京市朝阳区、上海市浦东新区、深圳市南山区" 
                               value="{{ job.location if job else '' }}" required>
                    </div>
                    <div class="form-group">
                        <label for="job_type">工作类型</label>
                        <select id="job_type" name="job_type">
                            <option value="全职" {% if job and job.job_type == '全职' %}selected{% endif %}>全职</option>
                            <option value="兼职" {% if job and job.job_type == '兼职' %}selected{% endif %}>兼职</option>
                            <option value="实习" {% if job and job.job_type == '实习' %}selected{% endif %}>实习</option>
                            <option value="合同工" {% if job and job.job_type == '合同工' %}selected{% endif %}>合同工</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="positions_needed">招聘人数 <span class="required">*</span></label>
                        <input type="number" id="positions_needed" name="positions_needed" min="1" 
                               value="{{ job.positions_needed if job else 1 }}" required>
                    </div>
                    <div class="form-group">
                        <label for="salary">薪资范围 <span class="required">*</span></label>
                        <input type="text" id="salary" name="salary" placeholder="如：8000-15000元/月" 
                               value="{{ job.salary if job else '' }}" required>
                    </div>
                </div>
            </div>

            <!-- 职位描述 -->
            <div class="form-section">
                <h3><i class="uil uil-file-alt"></i> 职位描述</h3>
                <div class="form-group">
                    <label for="description">工作职责和要求 <span class="required">*</span></label>
                    <textarea id="description" name="description" rows="6" placeholder="详细描述工作职责、岗位要求等..." required>{{ job.description if job else '' }}</textarea>
                </div>
            </div>

            <!-- 招聘要求 -->
            <div class="form-section">
                <h3><i class="uil uil-user-check"></i> 招聘要求</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="min_age">最小年龄</label>
                        <input type="number" id="min_age" name="min_age" min="18" max="65" placeholder="18"
                               value="{{ job.min_age if job and job.min_age else '' }}">
                    </div>
                    <div class="form-group">
                        <label for="max_age">最大年龄</label>
                        <input type="number" id="max_age" name="max_age" min="18" max="65" placeholder="65"
                               value="{{ job.max_age if job and job.max_age else '' }}">
                    </div>
                    <div class="form-group">
                        <label for="education_requirement">学历要求</label>
                        <select id="education_requirement" name="education_requirement">
                            <option value="">不限</option>
                            <option value="高中" {% if job and job.education_requirement == '高中' %}selected{% endif %}>高中</option>
                            <option value="大专" {% if job and job.education_requirement == '大专' %}selected{% endif %}>大专</option>
                            <option value="本科" {% if job and job.education_requirement == '本科' %}selected{% endif %}>本科</option>
                            <option value="硕士" {% if job and job.education_requirement == '硕士' %}selected{% endif %}>硕士</option>
                            <option value="博士" {% if job and job.education_requirement == '博士' %}selected{% endif %}>博士</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="experience_years">工作经验</label>
                        <input type="number" id="experience_years" name="experience_years" min="0" placeholder="0"
                               value="{{ job.experience_years if job and job.experience_years else '' }}">
                        <span class="input-suffix">年</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="skills_required">技能要求</label>
                    <textarea id="skills_required" name="skills_required" rows="4" placeholder="列出所需的专业技能、证书等...">{{ job.skills_required if job else '' }}</textarea>
                </div>
            </div>

            <!-- 福利待遇 -->
            <div class="form-section">
                <h3><i class="uil uil-gift"></i> 福利待遇</h3>
                <div class="form-group">
                    <label for="benefits">福利说明</label>
                    <textarea id="benefits" name="benefits" rows="4" placeholder="描述公司福利、培训机会、晋升空间等...">{{ job.benefits if job else '' }}</textarea>
                </div>
            </div>

            <!-- 联系方式 -->
            <div class="form-section">
                <h3><i class="uil uil-phone"></i> 联系方式</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="contact_email">联系邮箱</label>
                        <input type="email" id="contact_email" name="contact_email" placeholder="hr@company.com"
                               value="{{ job.contact_email if job else '' }}">
                    </div>
                    <div class="form-group">
                        <label for="contact_phone">联系电话</label>
                        <input type="tel" id="contact_phone" name="contact_phone" placeholder="+86 138-0000-0000"
                               value="{{ job.contact_phone if job else '' }}">
                    </div>
                </div>
            </div>

            <!-- 申请截止 -->
            <div class="form-section">
                <h3><i class="uil uil-calendar-alt"></i> 申请截止</h3>
                <div class="form-group">
                    <label for="application_deadline">申请截止日期</label>
                    <input type="date" id="application_deadline" name="application_deadline" 
                           value="{{ job.application_deadline.strftime('%Y-%m-%d') if job and job.application_deadline else '' }}"
                           min="{{ today_date }}">
                </div>
            </div>
        </div>

        <div class="form-actions">
            <button type="button" class="btn-secondary" onclick="history.back()">取消</button>
            <button type="submit" class="btn-primary">
                <i class="uil uil-paper-plane"></i>
                {% if is_edit %}更新招聘启事{% else %}发布招聘启事{% endif %}
            </button>
        </div>
    </form>
</div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            
            // 设置最小日期为今天
            document.getElementById('application_deadline').min = today;

            // 如果是编辑模式，设置日期字段
            {% if job and job.application_deadline %}
            const deadlineField = document.getElementById('application_deadline');
            if (deadlineField && !deadlineField.value) {
                deadlineField.value = '{{ job.application_deadline.strftime("%Y-%m-%d") }}';
            }
            {% endif %}

            // 表单验证
            const form = document.querySelector('.recruitment-form');
            form.addEventListener('submit', function(e) {
                const minAge = document.getElementById('min_age').value;
                const maxAge = document.getElementById('max_age').value;
                
                if (minAge && maxAge && parseInt(minAge) > parseInt(maxAge)) {
                    e.preventDefault();
                    alert('最小年龄不能大于最大年龄');
                    return;
                }
            });
        });
    </script>
{% endblock %}
