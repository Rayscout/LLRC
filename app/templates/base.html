<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='auth_sign.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='theme1.css') }}">
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="icon" href="https://mcp-media.8n6n.com/img/2025/08/20/c0ce9b147f51df7246a8d9ffb6a64012" />
    <title>{% block title %}HR招聘系统{% endblock %}</title>
    <style>
    /* 深色模式开关样式 */
    #themeToggle{ position:relative; display:inline-block; vertical-align:middle; cursor:pointer; pointer-events:auto; }
    #themeToggle::after{ content:""; position:absolute; top:2px; left:2px; width:18px; height:18px; border-radius:999px; background:#fff; box-shadow:0 1px 2px rgba(0,0,0,.2); transition:transform .2s ease; }
    #themeToggle:checked{ background:#111827; border-color:#111827; }
    #themeToggle:checked::after{ transform:translateX(18px); background:#e5e7eb; }

    /* 全局深色模式基础覆盖（毛玻璃流动感） */
    body.dark { color:#e5e7eb; background:#0b1220; }
    body.dark a { color:#e5e7eb; }
    /* 毛玻璃侧边栏 */
    body.dark nav { position:relative; background:rgba(15,23,42,.35); border-right:1px solid rgba(148,163,184,.25); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
    body.dark nav::before{ content:""; position:absolute; inset:0; background: radial-gradient(1200px 400px at -10% -20%, rgba(99,102,241,.18), transparent 60%), radial-gradient(1000px 380px at 120% 120%, rgba(236,72,153,.18), transparent 60%); background-size:200% 200%; animation:glassFlow 14s ease-in-out infinite; pointer-events:none; }
    body.dark nav .link-name, body.dark nav i { color:#e5e7eb; }
    /* 主内容毛玻璃背景 */
    body.dark .dashboard { background:linear-gradient(180deg, rgba(11,18,32,.75), rgba(11,18,32,.6)); }
    body.dark .dash-content { background:transparent; }
    body.dark .logout-mode .mode { background:transparent; }
    @keyframes glassFlow{ 0%{background-position:0% 0%} 50%{background-position:100% 100%} 100%{background-position:0% 0%} }

    /* 顶部快捷主题按钮 */
    .theme-btn{ border:1px solid #e5e7eb; background:#fff; color:#111827; border-radius:999px; padding:6px 10px; margin-left:10px; cursor:pointer }
    .theme-btn i{ pointer-events:none }
    body.dark .theme-btn{ background:#111827; color:#e5e7eb; border-color:#374151 }
    </style>
</head>
<body>
    <!-- 动效背景元素（全局） -->
    <div class="scroll-progress"></div>
    <div class="floating-shapes" id="floatingShapes"></div>
    <div class="animated-bg"><div class="bg-pattern"></div></div>
    <div class="particle-system" id="particleSystem"></div>
    <nav>
        <div class="logo-name">
            <div class="logo-image">
                <img src="{{ url_for('static', filename='Images/logo.png') }}" alt="标志">
            </div>
        </div>
        <div class="menu-items">
            <ul class="nav-links">
                {% if user and user.is_hr %}
                <!-- HR用户菜单 -->
                <li><a href="{{ url_for('smartrecruit.hr.dashboard.hr_dashboard') }}">
                    <i class="uil uil-dashboard"></i>
                    <span class="link-name">仪表盘</span>
                </a></li>
                <li><a href="{{ url_for('smartrecruit.hr.recruitment.publish_recruitment') }}">
                    <i class="uil uil-briefcase"></i>
                    <span class="link-name">发布职位</span>
                </a></li>
                <li><a href="{{ url_for('smartrecruit.hr.dashboard.candidates') }}">
                    <i class="uil uil-users-alt"></i>
                    <span class="link-name">候选人管理</span>
                </a></li>
                <li><a href="{{ url_for('smartrecruit.hr.dashboard.interviews') }}">
                    <i class="uil uil-calendar-alt"></i>
                    <span class="link-name">面试安排</span>
                </a></li>
                <li><a href="{{ url_for('smartrecruit.hr.dashboard.reports') }}">
                    <i class="uil uil-chart-pie"></i>
                    <span class="link-name">报表与分析</span>
                </a></li>
                <li><a href="{{ url_for('smartrecruit.hr.recruitment.my_jobs') }}">
                    <i class="uil uil-list-ul"></i>
                    <span class="link-name">已发布招聘</span>
                </a></li>
                {% else %}
                <!-- 求职者菜单 -->
                <li><a href="{{ url_for('smartrecruit.candidate.home') }}">
                    <i class="uil uil-home"></i>
                    <span class="link-name">首页</span>
                </a></li>
                <li><a href="{{ url_for('smartrecruit.candidate.jobs.job_search') }}">
                    <i class="uil uil-search"></i>
                    <span class="link-name">职位搜索</span>
                </a></li>
                <li><a href="{{ url_for('smartrecruit.candidate.applications.my_applications') }}">
                    <i class="uil uil-list-ul"></i>
                    <span class="link-name">我的申请</span>
                </a></li>
                <li><a href="{{ url_for('smartrecruit.candidate.applications.virtual_interview') }}">
                    <i class="uil uil-robot"></i>
                    <span class="link-name">AI虚拟面试</span>
                </a></li>
                <li><a href="{{ url_for('smartrecruit.candidate.profile.career_path') }}">
                    <i class="uil uil-chart"></i>
                    <span class="link-name">职业与技能</span>
                </a></li>
                <li><a href="{{ url_for('smartrecruit.candidate.profile.settings') }}">
                    <i class="uil uil-user"></i>
                    <span class="link-name">个人资料</span>
                </a></li>
                {% endif %}
            </ul>
            <ul class="logout-mode" style="position:sticky;bottom:12px;align-self:stretch;width:100%">
                <li><a href="{{ url_for('common.auth.logout') }}">
                    <i class="uil uil-signout"></i>
                    <span class="link-name">退出登录</span>
                </a></li>
            </ul>
        </div>
    </nav>
    <section class="dashboard">
        <div class="top">
            <i class="uil uil-bars sidebar-toggle"></i>
            <button id="topThemeBtn" class="theme-btn" type="button" title="切换深色/浅色"><i class="uil uil-moon"></i></button>
            {% if user and user.profile_photo %}
                <a href="{{ url_for('smartrecruit.candidate.profile.settings') if not user.is_hr else '#' }}">
                    <img src="{{ url_for('static', filename='uploads/photos/' + user.profile_photo) }}" alt="头像">
                </a>
            {% else %}
                <a href="{{ url_for('smartrecruit.candidate.profile.settings') if not user.is_hr else '#' }}">
                    <img src="{{ url_for('static', filename='Images/profile.jpg') }}" alt="默认头像">
                </a>
            {% endif %}
        </div>
        <div class="dash-content">
            {% block content %}{% endblock %}
        </div>
    </section>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <script src="{{ url_for('static', filename='auth_sign.js') }}"></script>
    <script>
    (function(){
        var body = document.body;
        var toggle = document.getElementById('themeToggle');
        var label = document.getElementById('themeToggleLabel');
        var topBtn = document.getElementById('topThemeBtn');
        // 侧栏开关可能不存在（已移除），但顶部按钮仍可使用

        function initialTheme(){
            try {
                var saved = localStorage.getItem('theme');
                if(saved){ return saved; }
            } catch(e) {}
            try {
                if(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches){
                    return 'dark';
                }
            } catch(e) {}
            return 'light';
        }

        function applyTheme(val, syncUI){
            if(val === 'dark'){
                body.classList.add('dark');
            } else {
                body.classList.remove('dark');
            }
            // 仅当需要同步时，才更新侧边栏滑块状态
            if(syncUI && toggle){
                toggle.checked = (val === 'dark');
                toggle.style.background = toggle.checked ? '#111827' : '#e5e7eb';
            }
        }

        applyTheme(initialTheme(), true);

        // 监听切换（侧边开关）
        if(toggle){
            toggle.addEventListener('change', function(){
                var theme = this.checked ? 'dark' : 'light';
                applyTheme(theme, true);
                try { localStorage.setItem('theme', theme); } catch(e){}
            });
        }

        // 兼容：点击整块标签也能切换
        if(label && toggle){
            label.addEventListener('click', function(e){
                if(e.target !== toggle){
                    toggle.checked = !toggle.checked;
                    var theme = toggle.checked ? 'dark' : 'light';
                    applyTheme(theme, true);
                    try { localStorage.setItem('theme', theme); } catch(e){}
                }
            });
        }

        // 顶部按钮切换
        if(topBtn){
            topBtn.addEventListener('click', function(){
                var toDark = !body.classList.contains('dark');
                applyTheme(toDark ? 'dark' : 'light', false);
                try { localStorage.setItem('theme', toDark ? 'dark' : 'light'); } catch(e){}
            });
        }

        // 兼容左下角旧样式按钮：.mode-toggle 或其父容器（如果存在）
        var legacyToggle = document.querySelector('.mode-toggle');
        if(legacyToggle){
            legacyToggle.addEventListener('click', function(){
                var toDark = !body.classList.contains('dark');
                applyTheme(toDark ? 'dark' : 'light', false);
                try { localStorage.setItem('theme', toDark ? 'dark' : 'light'); } catch(e){}
            });
        }
    })();
    </script>
</body>
</html>
